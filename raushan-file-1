This is the revised code
